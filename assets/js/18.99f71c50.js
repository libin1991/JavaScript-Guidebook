(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{181:function(t,s,e){t.exports=e.p+"assets/img/3abb98a7-576a-44bf-b90c-b7edc45e8d67.0c389301.png"},182:function(t,s,e){t.exports=e.p+"assets/img/456c7ab1-0dc8-4975-822e-66eb1739b474.4e812303.png"},379:function(t,s,e){"use strict";e.r(s);var a=[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"渲染树构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#渲染树构建","aria-hidden":"true"}},[this._v("#")]),this._v(" 渲染树构建")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"构建流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建流程","aria-hidden":"true"}},[this._v("#")]),this._v(" 构建流程")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("浏览器将 DOM 和 CSSOM 合并成一个 "),s("strong",[this._v("渲染树")]),this._v("，它会网罗网页上所有可见的 DOM 内容，以及每个节点的所有 CSSOM 样式信息。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(181),alt:"渲染树构建"}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("从 DOM 树的根节点开始遍历每个可见节点\n"),e("ul",[e("li",[t._v("某些节点不可见（例如脚本标记、元标记等），因为它们不会体现在渲染输出中，所以会被忽略。")]),t._v(" "),e("li",[t._v("某些节点通过 CSS 隐藏，因此在渲染树中也会被忽略，例如，样式设置为 "),e("code",[t._v("display: none")]),t._v(" 属性的节点。")])])]),t._v(" "),e("li",[t._v("对于每个可见节点，为其找到适配的 CSSOM 规则并应用它们。")]),t._v(" "),e("li",[t._v("发射可见节点，连同其内容和计算的样式。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"遍历文档树"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遍历文档树","aria-hidden":"true"}},[this._v("#")]),this._v(" 遍历文档树")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"非可视化元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#非可视化元素","aria-hidden":"true"}},[this._v("#")]),this._v(" 非可视化元素")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("非可视化的 DOM 元素不会被插入渲染树中。")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("例如， "),e("code",[t._v("<head>")]),t._v(" 标签以及里面的内容，以及 "),e("code",[t._v("display:none")]),t._v(" 的元素也会被去除，但是 "),e("code",[t._v("visibility")]),t._v(" 属性值为 "),e("code",[t._v("hidden")]),t._v(" 的元素仍会显示。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"复杂结构元素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#复杂结构元素","aria-hidden":"true"}},[this._v("#")]),this._v(" 复杂结构元素")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("部分 DOM 元素可对应多个可视化对象。它们往往是具有复杂结构的元素，无法用单一的矩形来描述。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("例如， "),s("code",[this._v("select")]),this._v(" 元素有 3 个渲染器：一个用于显示区域，一个用于下拉列表框，还有一个用于按钮。如果由于宽度不够，文本无法在一行中显示而分为多行，那么新的行也会作为新的呈现器而添加。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("另一个关于多渲染器的例子是格式无效的 HTML。根据 CSS 规范，行内元素只能仅包含块状元素或行内元素中的一种。如果出现了混合内容，则应创建匿名的块状渲染对象，以包裹行内元素。所以我们平时的 "),s("code",[this._v("inline-block")]),this._v(" 可以设置宽高。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"脱离文档流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脱离文档流","aria-hidden":"true"}},[this._v("#")]),this._v(" 脱离文档流")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("部分渲染对象对应于 DOM 节点，但树中所在的位置与 DOM 节点不同。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:e(182),alt:"渲染树及对应DOM树"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"样式计算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#样式计算","aria-hidden":"true"}},[this._v("#")]),this._v(" 样式计算")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("样式包括来自各种来源的"),s("strong",[this._v("样式表")]),this._v("、"),s("strong",[this._v("行内样式元素")]),this._v("和 "),s("strong",[this._v("HTML 中的可视化属性")]),this._v("。其中后者经过转化以匹配 CSS 样式属性。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("样式表的来源包括"),s("strong",[this._v("浏览器的默认样式表")]),this._v("、"),s("strong",[this._v("由网页作者提供的样式表")]),this._v("以及由"),s("strong",[this._v("浏览器用户提供的用户样式表")]),this._v("（浏览器允许您定义自己喜欢的样式。以 Firefox 为例，用户可以将自己喜欢的样式表放在 Firefox Profile 文件夹下）。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("样式数据是一个超大的结构，存储了无数的样式属性，这可能造成内存问题。")]),this._v(" "),s("li",[this._v("如果不进行优化，为每一个元素查找匹配的规则会造成性能问题。要为每一个元素遍历整个规则列表来寻找匹配规则，这是一项浩大的工程。选择器会具有很复杂的结构，这就会导致某个匹配过程一开始看起来很可能是正确的，但最终发现其实是徒劳的，必须尝试其他匹配路径。")]),this._v(" "),s("li",[this._v("应用规则涉及到相当复杂的层叠规则（用于定义这些规则的层次）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"共享样式数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#共享样式数据","aria-hidden":"true"}},[this._v("#")]),this._v(" 共享样式数据")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("这些元素必须处于相同的鼠标状态（例如，不允许其中一个是 "),e("code",[t._v(":hover")]),t._v(" 状态，而另一个不是）")]),t._v(" "),e("li",[t._v("任何元素都没有 "),e("code",[t._v("id")])]),t._v(" "),e("li",[t._v("标记名称应匹配")]),t._v(" "),e("li",[t._v("类属性应匹配")]),t._v(" "),e("li",[t._v("映射属性的集合必须是完全相同的")]),t._v(" "),e("li",[t._v("链接状态必须匹配")]),t._v(" "),e("li",[t._v("焦点状态必须匹配")]),t._v(" "),e("li",[t._v("任何元素都不应受属性选择器的影响，这里所说的“影响”是指在选择器中的任何位置有任何使用了属性选择器的选择器匹配")]),t._v(" "),e("li",[t._v("元素中不能有任何 "),e("code",[t._v("inline")]),t._v(" 样式属性")]),t._v(" "),e("li",[t._v("不能使用任何同级选择器。WebCore 在遇到任何同级选择器时，只会引发一个全局开关，并停用整个文档的样式共享（如果存在）。这包括 "),e("code",[t._v("+")]),t._v(" 选择器以及 "),e("code",[t._v(":first-child")]),t._v(" 和 "),e("code",[t._v(":last-child")]),t._v(" 等选择器。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"对规则进行处理以简化匹配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对规则进行处理以简化匹配","aria-hidden":"true"}},[this._v("#")]),this._v(" 对规则进行处理以简化匹配")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("外部样式表获样式元素中的 CSS 规则")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("p")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" blue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("行内样式属性及类似内容")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),e("span",{pre:!0,attrs:{class:"token style-attr language-css"}},[e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('="')]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" blue")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("HTML 可视化属性（映射到相关的样式规则）")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("bgcolor")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("blue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("p.error")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" red"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("#messageDiv")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 50px"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("div")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("margin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 5px"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-html extra-class"},[e("pre",{pre:!0,attrs:{class:"language-html"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("an error occurred"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("messageDiv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("this is a message"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("我们首先会为 "),e("code",[t._v("p")]),t._v(" 元素寻找匹配的规则。类表中有一个 "),e("code",[t._v("error")]),t._v(" 键，在下面可以找到 "),e("code",[t._v("p.error")]),t._v(" 的规则。"),e("code",[t._v("div")]),t._v(" 元素在 "),e("code",[t._v("id")]),t._v(" 表（键为 "),e("code",[t._v("id")]),t._v("）和标记表中有相关的规则。剩下的工作就是找出哪些根据键提取的规则是真正匹配的了。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"层叠顺序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#层叠顺序","aria-hidden":"true"}},[this._v("#")]),this._v(" 层叠顺序")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"样式表的级联顺序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#样式表的级联顺序","aria-hidden":"true"}},[this._v("#")]),this._v(" 样式表的级联顺序")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("某个样式属性的声明可能会出现在多个样式表中，也可能在同一个样式表中出现多次。这意味着应用规则的顺序极为重要。这称为 "),s("strong",[this._v("层叠")]),this._v(" 顺序。根据 CSS2 规范，层叠的顺序为（优先级从低到高）：")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("浏览器声明")]),t._v(" "),e("li",[t._v("用户普通声明")]),t._v(" "),e("li",[t._v("作者普通声明")]),t._v(" "),e("li",[t._v("作者的 "),e("code",[t._v("important")]),t._v(" 声明")]),t._v(" "),e("li",[t._v("用户的 "),e("code",[t._v("important")]),t._v(" 声明")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("浏览器声明是重要程度最低的，而用户只有将该声明标记为 "),s("code",[this._v("important")]),this._v(" 时才会覆盖网页作者的声明。同等级别的声明将根据 "),s("a",{attrs:{href:"#%E7%89%B9%E5%BC%82%E6%80%A7"}},[this._v("特异性")]),this._v(" 以及它们被定义时的顺序进行排序。HTML 可视化属性将被转换为匹配的 CSS 声明，它们被视为最低优先级的作者规则。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"特异性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特异性","aria-hidden":"true"}},[this._v("#")]),this._v(" 特异性")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("如果声明来自 "),e("code",[t._v("style")]),t._v(" 属性，而不是带有选择器的规则，则记为 1，否则记为 0（=a）")]),t._v(" "),e("li",[t._v("记为选择器中 ID 属性的个数（=b）")]),t._v(" "),e("li",[t._v("记为选择器中其他属性和伪类的个数（=c）")]),t._v(" "),e("li",[t._v("记为选择器中元素名称和伪元素的个数（=d）")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("将四个数字按 "),s("code",[this._v("a-b-c-d")]),this._v(" 这样连接起来（位于大数进位的数字系统中），构成特异性。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("例如，如果 "),s("code",[this._v("a = 14")]),this._v(" ，您可以使用十六进制。如果 "),s("code",[this._v("a = 17")]),this._v("，那么您需要使用十七进制；当然不太可能出现这种情况，除非是存在如下的选择器："),s("code",[this._v("html body div div p ...")]),this._v("（在选择器中出现了 17 个标记，这样的可能性极低）。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("🌰 "),s("strong",[this._v("标准示例：")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[t._v(" "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("*")]),t._v("             "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=0 d=0 -> specificity = 0,0,0,0 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("li")]),t._v("            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=0 d=1 -> specificity = 0,0,0,1 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("li:first-line")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("ul li")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=0 d=2 -> specificity = 0,0,0,2 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("ul ol+li")]),t._v("      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=0 d=3 -> specificity = 0,0,0,3 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("h1 + *[rel=up]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=1 d=1 -> specificity = 0,0,1,1 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("ul ol li.red")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=1 d=3 -> specificity = 0,0,1,3 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("li.red.level")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=0 c=2 d=1 -> specificity = 0,0,2,1 */")]),t._v("\n "),e("span",{pre:!0,attrs:{class:"token selector"}},[t._v("#x34y")]),t._v("         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=0 b=1 c=0 d=0 -> specificity = 0,1,0,0 */")]),t._v("\n style="),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* a=1 b=0 c=0 d=0 -> specificity = 1,0,0,0 */")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("参考资料：")])])}],n=e(0),r=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),e("p",[t._v("在 "),e("router-link",{attrs:{to:"./constructing-the-object-model.html"}},[t._v("构建对象模型")]),t._v(" 中，我们根据 HTML 和 CSS 输入构建了 DOM 树和 CSSOM 树。 不过，它们都是独立的对象，分别网罗文档不同方面的信息：一个描述内容，另一个则是描述需要对文档应用的样式规则。")],1),t._v(" "),e("p",[t._v("DOM 树和 CSSOM 树将合并后在浏览器屏幕上渲染像素")]),t._v(" "),e("ul",[e("li",[t._v("DOM 树与 CSSOM 树合并后形成渲染树")]),t._v(" "),e("li",[t._v("渲染树只包含渲染网页所需的节点")]),t._v(" "),e("li",[e("router-link",{attrs:{to:"./layout.html"}},[t._v("布局")]),t._v(" 计算每个对象的精确位置和大小")],1),t._v(" "),e("li",[t._v("最后一步是 "),e("router-link",{attrs:{to:"./painting.html"}},[t._v("绘制")]),t._v("，使用最终渲染树将像素渲染到屏幕上")],1)]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),e("p",[t._v("为了构建渲染树，浏览器大体上完成了下列工作：")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),e("p",[t._v("渲染对象是和 DOM 元素相对应，但这种对应关系并非一一对应。")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),e("p",[t._v("例如，浮动定位和绝对定位的元素处于正常的文本流之外，在两棵树上的位置不同，渲染树上标识出真实的结构，并用一个占位结构标识出它们原来的位置。")]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),e("p",[t._v("构建渲染树之前，需要计算每一个渲染对象的可视化属性。这是通过计算每个元素的样式属性来完成的。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),e("p",[t._v("样式计算存在以下难点：")]),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),e("p",[t._v("WebKit 节点会引用样式对象 (RenderStyle)。这些对象在某些情况下可以由不同节点共享。这些节点是同级关系，并且：")]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),e("p",[t._v("样式规则来源：")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),e("p",[t._v("后两种很容易和元素进行匹配，因为元素拥有样式属性，而且 HTML 属性可以使用元素作为键值进行映射。")]),t._v(" "),e("p",[t._v("样式表解析完毕后，系统会根据选择器将 CSS 规则添加到某个哈希表中。这些哈希表的选择器各不相同，包括 ID、类名称、标记名称等，还有一种通用哈希表，适合不属于上述类别的规则。如果是 ID 选择器，规则就会添加到 ID 表中；如果是类选择器，规则就会添加到类表中，以此类推。")]),t._v(" "),e("p",[t._v("这种处理可以大大简化规则匹配。我们无需查看每一条声明，只要从哈希表中提取元素的相关规则即可。这种优化方法可排除掉 95% 以上规则，因此在匹配过程中根本就不用考虑这些规则。")]),t._v(" "),e("p",[t._v("我们以如下的样式规则为例：")]),t._v(" "),t._m(29),e("p",[t._v("第一条规则将插入类表，第二条将插入 ID 表，而第三条将插入标记表。")]),t._v(" "),t._m(30),t._m(31),t._v(" "),t._m(32),t._v(" "),e("p",[t._v("样式对象具有与每个可视化属性一一对应的属性（均为 CSS 属性但更为通用）。如果某个属性未由任何匹配规则所定义，那么部分属性就可由父代元素样式对象继承。其他属性具有默认值。")]),t._v(" "),e("p",[t._v("如果定义不止一个，就会出现问题，需要通过层叠顺序来解决。")]),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),e("p",[t._v("选择器的特异性由 CSS2 规范定义：")]),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),e("p",[t._v("您使用的进取制取决于上述类别中的最高计数。")]),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),e("hr"),t._v(" "),t._m(43),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://juejin.im/post/5b0a6f1af265da0ddb63ecd9#heading-4",target:"_blank",rel:"noopener noreferrer"}},[t._v("📝 掘金：浏览器原理"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/#Style_Computation",target:"_blank",rel:"noopener noreferrer"}},[t._v("📝 浏览器的工作原理：新式网络浏览器幕后揭秘"),e("OutboundLink")],1)])])])},a,!1,null,null,null);s.default=r.exports}}]);