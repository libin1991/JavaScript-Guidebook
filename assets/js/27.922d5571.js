(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{202:function(t,e,s){t.exports=s.p+"assets/img/fffa7afc-2fa1-464b-9d7d-05bdade58ce1.336ee4bf.png"},630:function(t,e,s){"use strict";s.r(e);var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"http-身份验证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-身份验证","aria-hidden":"true"}},[this._v("#")]),this._v(" HTTP 身份验证")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"basic-认证实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-认证实例","aria-hidden":"true"}},[this._v("#")]),this._v(" Basic 认证实例")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("用户访问的资源："),e("code",[this._v("/protected_docs")])]),this._v(" "),e("li",[this._v("用户名、密码："),e("code",[this._v("chyingp")]),this._v("、"),e("code",[this._v("123456")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"步骤-1：用户访问受限资源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-1：用户访问受限资源","aria-hidden":"true"}},[this._v("#")]),this._v(" 步骤 1：用户访问受限资源")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("如下，用户访问受限资源 "),e("code",[this._v("/protected_docs")]),this._v("。请求报文如下：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[this._v("GET")]),this._v(" /protected_docs HTTP/1.1")]),this._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[this._v("Host:")]),this._v(" 127.0.0.1:3000\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"步骤-2：服务端返回-401-要求身份认证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-2：服务端返回-401-要求身份认证","aria-hidden":"true"}},[this._v("#")]),this._v(" 步骤 2：服务端返回 401 要求身份认证")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("服务端发现 "),e("code",[this._v("/protected_docs")]),this._v(" 为受限资源，于是向用户发送 401 状态码，要求进行身份认证。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token response-status"}},[this._v("HTTP/1.1 "),e("span",{pre:!0,attrs:{class:"token property"}},[this._v("401 Unauthorized")])]),this._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[this._v("WWW-Authenticate:")]),this._v(" Basic realm=protected_docs\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("响应首部中，通过"),e("code",[this._v("WWW-Authenticate")]),this._v("告知客户端，认证的方案是"),e("code",[this._v("basic")]),this._v("。同时以"),e("code",[this._v("realm")]),this._v("告知认证的范围。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[this._v("WWW-Authenticate:")]),this._v(" Basic realm=<需要保护资源的范围>\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"步骤-3：用户发送认证请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-3：用户发送认证请求","aria-hidden":"true"}},[this._v("#")]),this._v(" 步骤 3：用户发送认证请求")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(202),alt:"用户发送认证请求"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("以下为请求报文。"),e("code",[this._v("Authorization")]),this._v("请求首部中，包含了用户填写的用户名、密码。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[this._v("GET")]),this._v(" /protected_docs HTTP/1.1")]),this._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[this._v("Authorization:")]),this._v(" Basic Y2h5aW5ncDoxMjM0NTY=\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("Authorization")]),this._v("首部的格式为"),e("code",[this._v("Basic base64(userid:password)")]),this._v("。实际代码如下：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-http extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[this._v("Buffer.from('chyingp:123456').toString('base64'); // Y2h5aW5ncDoxMjM0NTY=\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"步骤-4：服务端验证请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-4：服务端验证请求","aria-hidden":"true"}},[this._v("#")]),this._v(" 步骤 4：服务端验证请求")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("根据用户请求资源的地址，确定资源对应的 realm。")]),this._v(" "),e("li",[this._v("解析 Authorization 请求首部，获得用户名、密码。")]),this._v(" "),e("li",[this._v("判断用户是否有访问该 realm 的权限。")]),this._v(" "),e("li",[this._v("验证用户名、密码是否匹配。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"安全缺陷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安全缺陷","aria-hidden":"true"}},[this._v("#")]),this._v(" 安全缺陷")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("在传输层未加密的情况下，用户明文密码可被中间人截获")]),this._v(" "),e("li",[this._v("明文密码一旦泄露，如果用户其他站点用了同样的明文密码（大概率），那么用户其他站点的安全防线也告破。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("传输层未加密的情况下，不要使用 Basic 认证。")]),this._v(" "),e("li",[this._v("如果使用 Basic 认证，登录密码由服务端生成。")]),this._v(" "),e("li",[this._v("如果可能，不要使用 Basic 认证。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("除了安全缺陷，Basic 认证还存在无法吊销认证的情况。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"身份验证和实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#身份验证和实践","aria-hidden":"true"}},[this._v("#")]),this._v(" 身份验证和实践")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ol",[s("li",[t._v("客户端使用用户名跟密码请求登录")]),t._v(" "),s("li",[t._v("服务端收到请求，去验证用户名与密码")]),t._v(" "),s("li",[t._v("验证成功后，服务端会签发一个 Token，再把这个 Token 发送给客户端")]),t._v(" "),s("li",[t._v("客户端收到 Token 以后可以把它存储起来，比如放在 Cookie 里或者 Local Storage 里")]),t._v(" "),s("li",[t._v("客户端每次向服务端请求资源的时候需要带着服务端签发的 Token")]),t._v(" "),s("li",[t._v("服务端收到请求，然后去验证客户端请求里面带着的 Token，如果验证成功，就向客户端返回请求的数据")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("参考资料：")])])}],r=s(0),i=Object(r.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("HTTP 提供一个用于权限控制和认证的通用框架。最常用的 HTTP 认证方案是 HTTP Basic authentication。本页介绍了通用的 HTTP 认证框架以及展示如何通过 HTTP Basic authentication 来限制权限访问您的服务器。")]),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("下面通过实例来讲解 Basic 认证是如何实现的，一共分 4 个步骤。假设：")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),s("p",[t._v("用户收到服务端响应后，填写用户名、密码，然后向服务端发送认证请求。")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),s("p",[t._v("服务端收到用户的认证请求后，对请求进行验证。验证包含如下步骤：")]),t._v(" "),t._m(18),t._v(" "),s("p",[t._v("一旦上述验证通过，则返回请求资源。如果验证失败，则返回 401 要求重新认证，或者返回 403（Forbidden）。")]),t._v(" "),t._m(19),t._v(" "),s("p",[t._v("Basic 认证的安全缺陷比较明显，它通过明文传输用户的密码，这会导致严重的安全问题。")]),t._v(" "),t._m(20),t._v(" "),s("p",[t._v("关于上述问题的建议：")]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),s("p",[s("a",{attrs:{href:"https://juejin.im/entry/5a586a716fb9a01ca871e714",target:"_blank",rel:"noopener noreferrer"}},[t._v("基于 Token 的身份验证和实践"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("HTTP Basic 提供的身份验证策略缺陷比较明显，当代应用较多使用 Token 的方式进行用户身份验证。")]),t._v(" "),s("p",[t._v("使用基于 Token 的身份验证方法，在服务端不需要存储用户的登录记录。大概的流程是这样的：")]),t._v(" "),t._m(24),t._v(" "),s("hr"),t._v(" "),t._m(25),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Authentication",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN HTTP Authentication"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.im/entry/5ac175baf265da239e4e3999",target:"_blank",rel:"noopener noreferrer"}},[t._v("一文读懂 HTTP Basic 身份认证"),s("OutboundLink")],1)])])])},a,!1,null,null,null);e.default=i.exports}}]);